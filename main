#!/bin/bash
#This shebang is for synax only. Do not make executable!

_export () { export $1=$2; }

_export MYBORG          $(cat ~/.local/var/myborg/current.txt)
_export MYBORG_BIN      ${HOME}/.local/var/myborg/mybin
_export MYBORG_MODS     ${MYBORG}/.mods
_export MYBORG_DOTS     ${MYBORG}/dots

DST=${MYBORG}/.borg
SRC="-b slim https://github.com/bryanhann/dot.borg"
[ -d ${DST} ] || git clone ${SRC} ${DST}
pushd ${DST} > /dev/null
source ./insitu
popd > /dev/null

myborg_clone_all

myborg_main () {
    source borg:__first__
    myborg source ${MYBORG_DOTS}/dot$1
    source borg:__last__
    source borg:path:clean
}

[ ! "$1" = "" ] && myborg main $*
